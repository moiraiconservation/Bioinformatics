///////////////////////////////////////////////////////////////////////////////
// clustal.js /////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
// OBJECT /////////////////////////////////////////////////////////////////////
function CLUSTAL() {
	////////////////////////////////////////////////////////////////////////
	// OBJECT //////////////////////////////////////////////////////////////
	function RECORD() {
		this.defline = '';
		this.sequence = '';
	}
  ////////////////////////////////////////////////////////////////////////
  this.parse = (str) => {
    const alignment = [];
    const lines = str.split('\n');
    let start = 0;
    if (lines[0].includes('CLUSTAL')) { start = 1; }
    for (let x = start; x < lines.length; x++) {
      if (lines[x].length) {
        const parts = lines[x].split(/\ +/);
        if (parts[0]) {
          const index = alignment.findIndex((a) => { return a.defline === parts[0]; });
          if (index > -1) { alignment[index].sequence += parts[1]; }
          else {
            const record = new RECORD();
            record.defline = parts[0];
            record.sequence = parts[1];
            alignment.push(record);
          }
        }
      }
    }
    return alignment;
  }
  ////////////////////////////////////////////////////////////////////////
}
///////////////////////////////////////////////////////////////////////////////